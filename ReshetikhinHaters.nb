(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84423,       2367]
NotebookOptionsPosition[     78581,       2268]
NotebookOutlinePosition[     78954,       2284]
CellTagsIndexPosition[     78911,       2281]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"qsubs", "=", 
   RowBox[{"{", 
    RowBox[{"qn", "\[Rule]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", " ", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q", "x"], "-", 
         SuperscriptBox["q", 
          RowBox[{"-", "x"}]]}], 
        RowBox[{"q", "-", 
         SuperscriptBox["q", 
          RowBox[{"-", "1"}]]}]]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nqsubs", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qn", " ", "\[Rule]", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", "x"}], "]"}]}], ",", 
     RowBox[{"q", "\[Rule]", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qAssum", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"qn", "[", "i", "]"}], ">", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qn", "[", "0", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qn", "[", "1", "]"}], "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.856962573805462*^9, 3.8569627257901745`*^9}, {
  3.8626618186982765`*^9, 3.862661849725174*^9}, {3.8626622253665657`*^9, 
  3.8626622553491273`*^9}, {3.8626648637192955`*^9, 3.862664865676237*^9}, {
  3.8722425433908167`*^9, 3.8722426423406878`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"f07d8d8b-4cdd-4ac2-b463-a20e101f3c43"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"qf", "[", "n_", "]"}], ":=", " ", 
   RowBox[{"Product", "[", 
    RowBox[{
     RowBox[{"qn", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.856963323511817*^9, 3.8569633721379957`*^9}, {
  3.8581541187513413`*^9, 3.858154119959042*^9}, {3.860054792549206*^9, 
  3.8600548361732254`*^9}, {3.8600549008635464`*^9, 3.8600549167621965`*^9}, {
  3.8600552268307524`*^9, 3.86005540261353*^9}, {3.862663054706233*^9, 
  3.8626630616920147`*^9}, {3.862663870422486*^9, 3.8626638787652545`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"ce087af6-e8b1-4a0c-89e3-d5e240d93ca2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Delta", "[", 
    RowBox[{"j1_", ",", "j2_", ",", "j3_"}], "]"}], ":=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"qf", "[", 
         RowBox[{"j1", "+", "j2", "-", "j3"}], "]"}], 
        RowBox[{"qf", "[", 
         RowBox[{"j1", "+", "j3", "-", "j2"}], "]"}], 
        RowBox[{"qf", "[", 
         RowBox[{"j2", "+", "j3", "-", "j1"}], "]"}]}], ")"}], "/", 
      RowBox[{"qf", "[", 
       RowBox[{"j1", "+", "j2", "+", "j3", "+", "1"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TriangleRule", "[", 
    RowBox[{"{", 
     RowBox[{"j1_", ",", "j2_", ",", "j3_"}], "}"}], "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"j1", "+", "j2"}], "\[GreaterEqual]", "j3"}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j1", "-", "j2"}], "]"}], "\[LessEqual]", "j3"}], 
          ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "True"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qClebschGordan", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j1_", ",", "m1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j2_", ",", "m2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j3_", ",", "m3_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ans", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ans", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "r"], 
          SuperscriptBox["q", 
           RowBox[{
            RowBox[{"-", "r"}], 
            RowBox[{"(", 
             RowBox[{"j1", "+", "j2", "+", "j3", "+", "1"}], ")"}]}]], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"qf", "[", 
              RowBox[{"j1", "-", "m1", "-", "r"}], "]"}], 
             RowBox[{"qf", "[", 
              RowBox[{"j3", "-", "j2", "+", "m1", "+", "r"}], "]"}], 
             RowBox[{"qf", "[", 
              RowBox[{"j2", "+", "m2", "-", "r"}], "]"}], 
             RowBox[{"qf", "[", 
              RowBox[{"j3", "-", "j1", "-", "m2", "+", "r"}], "]"}], 
             RowBox[{"qf", "[", "r", "]"}], 
             RowBox[{"qf", "[", 
              RowBox[{"j1", "+", "j2", "-", "j3", "-", "r"}], "]"}]}], ")"}], 
           RowBox[{"-", "1"}]]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"0", ",", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"j3", "-", "j2", "+", "m1"}], ")"}]}], ",", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"j3", "-", "j1", "-", "m2"}], ")"}]}]}], "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"j1", "+", "j2", "-", "j3"}], ",", 
             RowBox[{"j1", "-", "m1"}], ",", 
             RowBox[{"j2", "+", "m2"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ans", "*=", 
       RowBox[{
        RowBox[{"TriangleRule", "[", 
         RowBox[{"{", 
          RowBox[{"j1", ",", "j2", ",", "j3"}], "}"}], "]"}], 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{
          RowBox[{"m1", "+", "m2"}], ",", "m3"}], "]"}], 
        SqrtBox[
         RowBox[{"qn", "[", 
          RowBox[{
           RowBox[{"2", "j3"}], "+", "1"}], "]"}]], 
        RowBox[{"Delta", "[", 
         RowBox[{"j1", ",", "j2", ",", "j3"}], "]"}], 
        SuperscriptBox["q", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"j1", "+", "j2", "-", "j3"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"j1", "+", "j2", "+", "j3", "+", "1"}], ")"}]}], "+", 
          RowBox[{"j1", " ", "m2"}], "-", 
          RowBox[{"j2", " ", "m1"}]}]], 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qf", "[", 
            RowBox[{"j1", "+", "m1"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"j1", "-", "m1"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"j2", "+", "m2"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"j2", "-", "m2"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"j3", "+", "m3"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"j3", "-", "m3"}], "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", "ans"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"qThreeJSymbol", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j1_", ",", "m1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j2_", ",", "m2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j3_", ",", "m3_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"j1", "+", "j2", "-", "m3"}]], 
        SuperscriptBox["q", 
         RowBox[{"-", "m3"}]]}], 
       SqrtBox[
        RowBox[{"qn", "[", 
         RowBox[{
          RowBox[{"2", "j3"}], "+", "1"}], "]"}]]], 
      RowBox[{"CouplingCoef", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j1", ",", "m1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j2", ",", "m2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j3", ",", 
          RowBox[{"-", "m3"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.862663069165039*^9, 3.8626631494742575`*^9}, {
   3.8626632140369754`*^9, 3.862663438612641*^9}, {3.862663496431168*^9, 
   3.8626635271132545`*^9}, {3.8626636446761494`*^9, 3.862663787771886*^9}, {
   3.862663821875949*^9, 3.8626638427474394`*^9}, {3.8626638815059257`*^9, 
   3.8626639730805454`*^9}, {3.86266407422085*^9, 3.8626641409890575`*^9}, {
   3.8626648049025593`*^9, 3.862664805730345*^9}, {3.8630852288554387`*^9, 
   3.863085242496092*^9}, 3.8630863767123284`*^9, {3.8630865996571584`*^9, 
   3.863086617063579*^9}, {3.8630867190959487`*^9, 3.8630867225838547`*^9}, {
   3.8630881317726583`*^9, 3.8630881885276365`*^9}, {3.8630887330833306`*^9, 
   3.8630887733240733`*^9}, {3.863089189993282*^9, 3.863089202877678*^9}, {
   3.863089642758824*^9, 3.8630896438773613`*^9}, {3.863089702281017*^9, 
   3.8630897031759186`*^9}, {3.8630900769310503`*^9, 
   3.8630901040072126`*^9}, {3.863090487745677*^9, 3.8630904903223195`*^9}, {
   3.8630908860688157`*^9, 3.863090889487398*^9}, 3.863100655131897*^9, {
   3.8631008846791825`*^9, 3.863100886876676*^9}, {3.863100921810251*^9, 
   3.863101010480739*^9}, {3.8631010462928643`*^9, 3.863101098521023*^9}, {
   3.8631011324113264`*^9, 3.8631011452765427`*^9}, {3.8631012550935316`*^9, 
   3.8631012569320283`*^9}, {3.8631014008934135`*^9, 3.863101480191743*^9}, {
   3.8631015330666776`*^9, 3.863101584965584*^9}, {3.8631017561274724`*^9, 
   3.8631017727834845`*^9}, {3.8631020517553835`*^9, 
   3.8631020531641436`*^9}, {3.8631020876744423`*^9, 3.863102110427004*^9}, 
   3.8631024571663585`*^9, {3.8631025023373084`*^9, 3.8631025569425545`*^9}, {
   3.8631040971567144`*^9, 3.863104123029892*^9}, {3.863104187922451*^9, 
   3.86310418983922*^9}, {3.863104236173135*^9, 3.8631042407432127`*^9}, {
   3.863104321359509*^9, 3.8631043310145893`*^9}, 3.8631043830179143`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"cd803d39-84b6-4e13-a501-4587118a5c96"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Formula", " ", 
    RowBox[{"(", "3.7", ")"}], " ", "check"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"l1", "=", "1"}], ";", 
    RowBox[{"l2", "=", "2"}], ";", 
    RowBox[{"l3", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"qClebschGordan", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"l1", ",", "m1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l2", ",", "m2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l3", ",", "m3"}], "}"}]}], "]"}], 
           RowBox[{"qClebschGordan", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"l1", ",", "m1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l2", ",", "m2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l3", ",", "m3p"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"m1", ",", 
            RowBox[{"-", "l1"}], ",", "l1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m2", ",", 
            RowBox[{"-", "l2"}], ",", "l2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m3", ",", 
          RowBox[{"-", "l3"}], ",", "l3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m3p", ",", 
          RowBox[{"-", "l3"}], ",", "l3"}], "}"}]}], "]"}], "/.", "qsubs"}], "//",
      "FullSimplify"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.863104489654616*^9, 
  3.863104676667349*^9}},ExpressionUUID->"7e1f824b-72fe-46b1-b79e-\
7b9f12b2da86"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8631045584861712`*^9, {3.863104641387755*^9, 
   3.863104678931325*^9}},ExpressionUUID->"48d2705a-66cb-4303-91af-\
620e0e98fc32"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Formula", " ", 
    RowBox[{"(", "3.8", ")"}], " ", "check"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"l1", "=", "1"}], ";", 
    RowBox[{"l2", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"qClebschGordan", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"l1", ",", "m1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l2", ",", "m2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j3", ",", "m3"}], "}"}]}], "]"}], 
               RowBox[{"qClebschGordan", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"l1", ",", "m1p"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l2", ",", "m2p"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j3", ",", "m3"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"m3", ",", 
                RowBox[{"-", "j3"}], ",", "j3"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j3", ",", 
              RowBox[{"Abs", "[", 
               RowBox[{"l1", "-", "l2"}], "]"}], ",", 
              RowBox[{"l1", "+", "l2"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"m1", ",", 
            RowBox[{"-", "l1"}], ",", "l1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m1p", ",", 
            RowBox[{"-", "l1"}], ",", "l1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m2", ",", 
            RowBox[{"-", "l2"}], ",", "l2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m2p", ",", 
            RowBox[{"-", "l2"}], ",", "l2"}], "}"}]}], "]"}], "]"}], "/.", 
       "qsubs"}], ",", 
      RowBox[{"q", ">", "0"}]}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8631047000037622`*^9, 
  3.863104944241021*^9}},ExpressionUUID->"6dcf4b9f-8282-414d-ae4c-\
6e55ecc3b160"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0", "0"},
         {"0", "1", "0", "0", "0"},
         {"0", "0", "1", "0", "0"},
         {"0", "0", "0", "1", "0"},
         {"0", "0", "0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0", "0"},
         {"0", "1", "0", "0", "0"},
         {"0", "0", "1", "0", "0"},
         {"0", "0", "0", "1", "0"},
         {"0", "0", "0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "0", "0"},
         {"0", "1", "0", "0", "0"},
         {"0", "0", "1", "0", "0"},
         {"0", "0", "0", "1", "0"},
         {"0", "0", "0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.863104829769225*^9, 3.863104841059332*^9}, {
  3.863104874217062*^9, 3.863104891957671*^9}, {3.86310493156135*^9, 
  3.8631049520572596`*^9}},ExpressionUUID->"23cf3a2e-8f0c-4f4e-b9fb-\
bda98a0c1d4a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"qSixJSymbol", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j1_", ",", "j2_", ",", "j3_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j4_", ",", "j5_", ",", "j6_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Delta", "[", 
       RowBox[{"j1", ",", "j2", ",", "j3"}], "]"}], 
      RowBox[{"Delta", "[", 
       RowBox[{"j1", ",", "j5", ",", "j6"}], "]"}], 
      RowBox[{"Delta", "[", 
       RowBox[{"j5", ",", "j3", ",", "j4"}], "]"}], 
      RowBox[{"Delta", "[", 
       RowBox[{"j4", ",", "j2", ",", "j6"}], "]"}], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "z"], 
           RowBox[{"qf", "[", 
            RowBox[{"z", "+", "1"}], "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qf", "[", 
            RowBox[{"z", "-", "j1", "-", "j2", "-", "j3"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"z", "-", "j1", "-", "j5", "-", "j6"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"z", "-", "j2", "-", "j4", "-", "j6"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"z", "-", "j3", "-", "j4", "-", "j5"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"j1", "+", "j2", "+", "j4", "+", "j5", "-", "z"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"j1", "+", "j3", "+", "j4", "+", "j6", "-", "z"}], "]"}], 
           RowBox[{"qf", "[", 
            RowBox[{"j2", "+", "j3", "+", "j5", "+", "j6", "-", "z"}], 
            "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"j1", "+", "j2", "+", "j3"}], ",", 
            RowBox[{"j1", "+", "j5", "+", "j6"}], ",", 
            RowBox[{"j2", "+", "j4", "+", "j6"}], ",", 
            RowBox[{"j3", "+", "j4", "+", "j5"}]}], "]"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"j1", "+", "j2", "+", "j4", "+", "j5"}], ",", 
            RowBox[{"j1", "+", "j3", "+", "j4", "+", "j6"}], ",", 
            RowBox[{"j2", "+", "j3", "+", "j5", "+", "j6"}]}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"qAssum", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j1", "+", "j2", "+", "j4", "+", "j5"}], ",", 
         RowBox[{"j1", "+", "j3", "+", "j4", "+", "j6"}], ",", 
         RowBox[{"j2", "+", "j3", "+", "j5", "+", "j6"}]}], "]"}], "+", "1"}],
       "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qRacahWigner", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j1_", ",", "j2_", ",", "j3_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j4_", ",", "j5_", ",", "j6_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"j1", "+", "j2", "-", "j5", "-", "j4", "-", 
        RowBox[{"2", "j3"}]}]], 
      SqrtBox[
       RowBox[{
        RowBox[{"qn", "[", 
         RowBox[{
          RowBox[{"2", "j3"}], "+", "1"}], "]"}], 
        RowBox[{"qn", "[", 
         RowBox[{
          RowBox[{"2", "j6"}], "+", "1"}], "]"}]}]], 
      RowBox[{"qSixJSymbol", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j1", ",", "j2", ",", "j3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j4", ",", "j5", ",", "j6"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"qAssum", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"j1", "+", "j2", "+", "j4", "+", "j5"}], ",", 
         RowBox[{"j1", "+", "j3", "+", "j4", "+", "j6"}], ",", 
         RowBox[{"j2", "+", "j3", "+", "j5", "+", "j6"}]}], "]"}], "+", "1"}],
       "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8722406611364737`*^9, 3.872240694170645*^9}, {
   3.8722407346996036`*^9, 3.8722408716128817`*^9}, {3.872240907239802*^9, 
   3.8722409160843725`*^9}, {3.872241634153765*^9, 3.8722417433944817`*^9}, {
   3.8722417750041046`*^9, 3.872241860663368*^9}, {3.8722422217915163`*^9, 
   3.8722422572219715`*^9}, 3.872242419569682*^9, {3.872242449836358*^9, 
   3.8722424498987894`*^9}, {3.8722426642218695`*^9, 3.8722426888227663`*^9}, 
   3.8722427283319187`*^9, {3.8722427588467894`*^9, 3.8722427768743362`*^9}, {
   3.872242828950232*^9, 3.872242831432868*^9}, {3.872245268748062*^9, 
   3.872245275067545*^9}, {3.8722457107460513`*^9, 3.87224571117823*^9}, {
   3.8722460173226323`*^9, 3.872246082084442*^9}, {3.872246172964883*^9, 
   3.87224617308963*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"87fc8456-18e2-4997-8f63-fec86743cf89"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"j", "=", "1"}], "*)"}]], "Input",
 CellChangeTimes->{{3.87277505211248*^9, 
  3.8727750599762836`*^9}},ExpressionUUID->"08df1fe9-5f3b-4d9e-bded-\
b6aa20dc5b6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"3", "/", "2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"3", "/", "2"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8722430956019163`*^9, 3.8722431218895674`*^9}, {
  3.8722432782025385`*^9, 3.8722433779711742`*^9}, {3.872245956712648*^9, 
  3.872245956772628*^9}, {3.872246455225671*^9, 3.8722464557154827`*^9}, {
  3.8722465117037983`*^9, 3.8722465118810687`*^9}, {3.872247213167451*^9, 
  3.8722472136865273`*^9}},ExpressionUUID->"0e37994d-fdc6-4211-a006-\
feab36c1b298"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Racah", " ", "matrix", " ", "for", " ", "B3"}], " ", "\[Rule]", 
    " ", "B1"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"B1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"B3", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"qRacahWigner", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"B3", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"B3", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", "1", ",", 
             RowBox[{"B1", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"X1", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.872243388590399*^9, 3.872243401631258*^9}, {
   3.8722434427944155`*^9, 3.8722434839910793`*^9}, {3.8722435296922607`*^9, 
   3.872243649531802*^9}, {3.8722440576101832`*^9, 3.8722440918647413`*^9}, {
   3.8722441330692964`*^9, 3.8722441565212483`*^9}, {3.872244192031226*^9, 
   3.8722442251919823`*^9}, 3.87224516814081*^9, {3.872245720697152*^9, 
   3.872245720892993*^9}, {3.8722459629711304`*^9, 3.8722459650031176`*^9}, 
   3.872246188054661*^9, {3.8722463912313113`*^9, 3.8722463925373974`*^9}, {
   3.872246570830945*^9, 3.8722465756876483`*^9}, {3.8722466170502367`*^9, 
   3.8722466362033896`*^9}, {3.8722466802266493`*^9, 
   3.8722466809940014`*^9}, {3.87224743979373*^9, 3.8722474875632315`*^9}, {
   3.872248400666424*^9, 3.872248423760112*^9}, 
   3.8727754518421235`*^9},ExpressionUUID->"33531bfb-6863-4891-8406-\
90b634f77bf2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"qn", "[", "3", "]"}]]]}], 
      FractionBox["1", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"qn", "[", "2", "]"}], " ", 
          RowBox[{"qn", "[", "3", "]"}]}], 
         RowBox[{"qn", "[", "4", "]"}]]]]},
     {"0", 
      FractionBox[
       RowBox[{"qn", "[", "4", "]"}], 
       SqrtBox[
        RowBox[{
         RowBox[{"qn", "[", "2", "]"}], " ", 
         RowBox[{"qn", "[", "3", "]"}], " ", 
         RowBox[{"qn", "[", "4", "]"}]}]]], 
      FractionBox["1", 
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8722436455190163`*^9, 3.8722436497662983`*^9}, 
   3.8722442265995684`*^9, 3.872245168540364*^9, {3.8722455659668083`*^9, 
   3.872245579090965*^9}, 3.8722456128111153`*^9, 3.872245724014166*^9, {
   3.872245959930258*^9, 3.8722459652223616`*^9}, {3.8722460349254208`*^9, 
   3.872246085037321*^9}, {3.8722461659842415`*^9, 3.872246188709071*^9}, 
   3.8722463933776484`*^9, 3.872246600964398*^9, 3.872246697987135*^9, 
   3.8722468201760283`*^9, 3.8722472258605986`*^9, 3.872247495794037*^9, 
   3.8722484351017094`*^9},ExpressionUUID->"c338b2b3-ac84-4e73-aa5d-\
6655a2b4ad31"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Racah", " ", "matrix", " ", "for", " ", "B2"}], " ", "\[Rule]", 
    " ", "B3"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"U1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"B2", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"B3", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"qRacahWigner", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"B3", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"B3", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"B2", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"U1", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{
  3.8722468312988434`*^9, {3.872246922606147*^9, 3.8722470411963425`*^9}, {
   3.872247072082382*^9, 3.8722470816170807`*^9}, {3.87224747483678*^9, 
   3.8722474932454023`*^9}, {3.8722484287941484`*^9, 
   3.8722484316788807`*^9}},ExpressionUUID->"5b691d81-56c0-4998-b23f-\
10620de0b41a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"qn", "[", "2", "]"}]]}], 
      FractionBox[
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]], 
       RowBox[{"qn", "[", "2", "]"}]], "0"},
     {
      FractionBox[
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]], 
       RowBox[{"qn", "[", "2", "]"}]], 
      FractionBox["1", 
       RowBox[{"qn", "[", "2", "]"}]], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8722469787245207`*^9, {3.8722470247235293`*^9, 3.872247041884843*^9}, 
   3.872247090814184*^9, 3.872247142929831*^9, 3.872247228843024*^9, {
   3.872247477497565*^9, 3.8722474976513157`*^9}, 
   3.8722484372024207`*^9},ExpressionUUID->"24c72957-7ca1-4dca-a28c-\
68f5cf4dacff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Change", " ", "of", " ", "basis", " ", "B1"}], " ", "\[Rule]", 
    " ", "B2"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S1", "=", 
     RowBox[{"U1", ".", 
      RowBox[{"Transpose", "[", "X1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"S1", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.872247900437502*^9, 3.8722479478454237`*^9}, {
  3.872248439595324*^9, 
  3.8722484583969812`*^9}},ExpressionUUID->"b5d8e358-be22-41b1-b195-\
27be5bf4cbe0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"qn", "[", "2", "]"}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"qn", "[", "2", "]"}]]}], 
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{"qn", "[", "3", "]"}]], " ", 
        RowBox[{"qn", "[", "4", "]"}]}], 
       RowBox[{
        RowBox[{"qn", "[", "2", "]"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"qn", "[", "2", "]"}], " ", 
          RowBox[{"qn", "[", "3", "]"}], " ", 
          RowBox[{"qn", "[", "4", "]"}]}]]}]]},
     {
      FractionBox[
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]], 
       RowBox[{"qn", "[", "2", "]"}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"qn", "[", "2", "]"}], " ", 
         SqrtBox[
          RowBox[{"qn", "[", "3", "]"}]]}]]}], 
      FractionBox[
       RowBox[{"qn", "[", "4", "]"}], 
       RowBox[{
        RowBox[{"qn", "[", "2", "]"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"qn", "[", "2", "]"}], " ", 
          RowBox[{"qn", "[", "3", "]"}], " ", 
          RowBox[{"qn", "[", "4", "]"}]}]]}]]},
     {"0", 
      FractionBox["1", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"qn", "[", "2", "]"}], " ", 
          RowBox[{"qn", "[", "3", "]"}]}], 
         RowBox[{"qn", "[", "4", "]"}]]]], 
      FractionBox["1", 
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.872247948164448*^9, 
  3.8722484613278284`*^9},ExpressionUUID->"bc0c9f24-2cfd-4a28-8cf8-\
2ca3822b12e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Eigenvalues", " ", "of", " ", "R"}], "-", 
     RowBox[{"matrices", " ", "for", " ", "j"}]}], "=", "1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T11", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B1", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T12", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B2", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T13", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B1", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"T11", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"T12", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"T13", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8722475803307962`*^9, 3.8722475936967764`*^9}, {
  3.872247643600891*^9, 3.8722476601481023`*^9}, {3.8722476924788184`*^9, 
  3.8722477596973104`*^9}, {3.8722478021486835`*^9, 3.872247874136243*^9}, {
  3.8722481943364797`*^9, 3.8722482361231833`*^9}, {3.8722483507693796`*^9, 
  3.872248376707708*^9}},ExpressionUUID->"d46dc022-ecc3-4c9e-9bcc-\
0787334a76b1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0"},
     {"0", 
      SuperscriptBox["q", "2"], "0"},
     {"0", "0", 
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8722477115059805`*^9, 3.8722477248442554`*^9}, {
   3.8722478080144553`*^9, 3.8722478245614877`*^9}, 3.8722478745332875`*^9, 
   3.8722482035449758`*^9, 3.8722482370257072`*^9, 
   3.872248466380579*^9},ExpressionUUID->"ec10d392-a8f8-465d-8f37-\
e701a96698d5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0"},
     {"0", 
      SuperscriptBox["q", "2"], "0"},
     {"0", "0", 
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8722477115059805`*^9, 3.8722477248442554`*^9}, {
   3.8722478080144553`*^9, 3.8722478245614877`*^9}, 3.8722478745332875`*^9, 
   3.8722482035449758`*^9, 3.8722482370257072`*^9, 
   3.872248466397895*^9},ExpressionUUID->"f54d84dd-9e49-4559-bf54-\
ce9fd74ee81a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox["q", "2"], "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", 
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8722477115059805`*^9, 3.8722477248442554`*^9}, {
   3.8722478080144553`*^9, 3.8722478245614877`*^9}, 3.8722478745332875`*^9, 
   3.8722482035449758`*^9, 3.8722482370257072`*^9, 
   3.8722484664129615`*^9},ExpressionUUID->"c2e7508c-7d75-446a-b430-\
d34d64ac74de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Yang", "-", 
    RowBox[{"Baxter", " ", "check"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"T11", ".", 
           RowBox[{"Transpose", "[", "S1", "]"}], ".", "T12", ".", "S1", ".", 
           "T11"}], ",", 
          RowBox[{"qAssum", "[", "4", "]"}]}], "]"}], "-", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", "S1", "]"}], ".", "T12", ".", "S1", ".", 
           "T11", ".", 
           RowBox[{"Transpose", "[", "S1", "]"}], ".", "T12", ".", "S1"}], 
          ",", 
          RowBox[{"qAssum", "[", "4", "]"}]}], "]"}]}], ")"}], "/.", 
      "qsubs"}], ",", 
     RowBox[{"q", ">", "0"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"T13", ".", 
           RowBox[{"Transpose", "[", "S1", "]"}], ".", "T12", ".", "S1", ".", 
           "T13"}], ",", 
          RowBox[{"qAssum", "[", "4", "]"}]}], "]"}], "-", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", "S1", "]"}], ".", "T12", ".", "S1", ".", 
           "T13", ".", 
           RowBox[{"Transpose", "[", "S1", "]"}], ".", "T12", ".", "S1"}], 
          ",", 
          RowBox[{"qAssum", "[", "4", "]"}]}], "]"}]}], ")"}], "/.", 
      "qsubs"}], ",", 
     RowBox[{"q", ">", "0"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.872247983097754*^9, 3.872248060889876*^9}, {
  3.8722481426315055`*^9, 3.8722481758404045`*^9}, {3.872248240040738*^9, 
  3.8722482556142473`*^9}, {3.872248313196412*^9, 
  3.8722483245589466`*^9}},ExpressionUUID->"ae2196e9-36cd-4527-8502-\
f80f768ae4ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8722480422605333`*^9, 3.872248061671381*^9}, {
   3.8722481789552784`*^9, 3.872248207046979*^9}, {3.8722483078811083`*^9, 
   3.872248328400201*^9}, 
   3.87224852132771*^9},ExpressionUUID->"e546bf9e-9eb1-492f-834f-\
55b4a7d5e4d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8722480422605333`*^9, 3.872248061671381*^9}, {
   3.8722481789552784`*^9, 3.872248207046979*^9}, {3.8722483078811083`*^9, 
   3.872248328400201*^9}, 
   3.872248523812146*^9},ExpressionUUID->"8fcbb26b-9b19-45d4-8671-\
fba7aa8c6d72"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"j", "=", "0"}], "*)"}]], "Input",
 CellChangeTimes->{{3.872826892483595*^9, 
  3.8728268980964637`*^9}},ExpressionUUID->"eccf3e3f-555f-400f-a52d-\
963924587718"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B10", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B20", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B30", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8728269014511185`*^9, 3.8728269930811152`*^9}, {
  3.87282716034389*^9, 3.872827164082245*^9}, {3.872827432354602*^9, 
  3.8728274358976183`*^9}, {3.87282918464109*^9, 3.872829186175768*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"2cfa4112-1957-4e92-b499-984338e5b025"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Racah", " ", "matrix", " ", "for", " ", "B3"}], " ", "\[Rule]", 
    " ", "B2"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"U2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"B20", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"B30", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"qRacahWigner", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"B30", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"B30", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"B20", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"U2", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.872827589177614*^9, 3.872827610398864*^9}, {
  3.87282774494052*^9, 3.872827748468476*^9}, {3.872828237772632*^9, 
  3.872828240681731*^9}, {3.872828296223364*^9, 3.8728282995068483`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"7ab3203a-4998-4238-a047-9e81dcd13410"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"qn", "[", "2", "]"}]]}], 
      FractionBox[
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]], 
       RowBox[{"qn", "[", "2", "]"}]]},
     {
      FractionBox[
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]], 
       RowBox[{"qn", "[", "2", "]"}]], 
      FractionBox["1", 
       RowBox[{"qn", "[", "2", "]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8728291927686687`*^9},
 CellLabel->
  "Out[40]//MatrixForm=",ExpressionUUID->"8b8058ed-7f8b-4a57-a494-\
2d12079cdb12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Racah", " ", "matrix", " ", "for", " ", "B3"}], " ", "\[Rule]", 
    " ", "B1"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"B10", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"B30", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"qRacahWigner", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"B30", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"B30", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", "0", ",", 
             RowBox[{"B10", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"X2", "//", "MatrixForm"}]}]}]], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"ef6643c4-6407-4934-9d3a-4d82b980c4e1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.872828389029033*^9, 3.872829203723301*^9},
 CellLabel->
  "Out[42]//MatrixForm=",ExpressionUUID->"07555495-3e63-4b18-9378-\
e9d37fb06a6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Change", " ", "of", " ", "basis", " ", "B1"}], " ", "\[Rule]", 
    " ", "B2"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S2", "=", 
     RowBox[{"U2", ".", 
      RowBox[{"Transpose", "[", "X2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"S2", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8728282739794374`*^9, 3.872828313022312*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"fc134c02-d41d-4375-8b69-ee5446a4b9cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"qn", "[", "2", "]"}]]}], 
      FractionBox[
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]], 
       RowBox[{"qn", "[", "2", "]"}]]},
     {
      FractionBox[
       SqrtBox[
        RowBox[{"qn", "[", "3", "]"}]], 
       RowBox[{"qn", "[", "2", "]"}]], 
      FractionBox["1", 
       RowBox[{"qn", "[", "2", "]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.872828284255721*^9, 3.8728282879393444`*^9}, 
   3.8728283253712406`*^9, 3.8728283952383165`*^9, 3.872829211080105*^9},
 CellLabel->
  "Out[44]//MatrixForm=",ExpressionUUID->"ecb70ca7-b6d5-4b96-a1a1-\
71af595abbca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Eigenvalues", " ", "of", " ", "R"}], "-", 
     RowBox[{"matrices", " ", "for", " ", "j"}]}], "=", "1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T110", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B10", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B10", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B10", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T120", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B20", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B20", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B20", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T130", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B10", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B10", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B10", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"T110", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"T120", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"T130", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8728320232258387`*^9, 3.8728320722140813`*^9}, {
  3.872832169955181*^9, 3.872832178803528*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"a8395fad-f49d-4016-98db-2e656474d2dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0"},
     {"0", 
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8728320279789677`*^9, 3.872832074225772*^9, 
  3.8728321808257074`*^9},
 CellLabel->
  "Out[70]//MatrixForm=",ExpressionUUID->"6d7cd457-c552-4517-b459-\
6ae6e4d03434"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0"},
     {"0", 
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8728320279789677`*^9, 3.872832074225772*^9, 
  3.872832180841328*^9},
 CellLabel->
  "Out[71]//MatrixForm=",ExpressionUUID->"ac093962-4cde-49c5-bf61-\
b53a8048a00d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0"},
     {"0", 
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8728320279789677`*^9, 3.872832074225772*^9, 
  3.872832180841328*^9},
 CellLabel->
  "Out[72]//MatrixForm=",ExpressionUUID->"fd297542-503c-4e81-9142-\
84a246aca343"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"T110", ".", 
         RowBox[{"Transpose", "[", "S2", "]"}], ".", "T120", ".", "S2", ".", 
         "T110"}], ",", 
        RowBox[{"qAssum", "[", "3", "]"}]}], "]"}], "-", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "S2", "]"}], ".", "T120", ".", "S2", ".", 
         "T110", ".", 
         RowBox[{"Transpose", "[", "S2", "]"}], ".", "T120", ".", "S2"}], ",", 
        RowBox[{"qAssum", "[", "3", "]"}]}], "]"}]}], ")"}], "/.", "qsubs"}], 
   ",", 
   RowBox[{"q", ">", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"T130", ".", 
         RowBox[{"Transpose", "[", "S2", "]"}], ".", "T120", ".", "S2", ".", 
         "T130"}], ",", 
        RowBox[{"qAssum", "[", "3", "]"}]}], "]"}], "-", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "S2", "]"}], ".", "T120", ".", "S2", ".", 
         "T130", ".", 
         RowBox[{"Transpose", "[", "S2", "]"}], ".", "T120", ".", "S2"}], ",", 
        RowBox[{"qAssum", "[", "3", "]"}]}], "]"}]}], ")"}], "/.", "qsubs"}], 
   ",", 
   RowBox[{"q", ">", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8728321580773573`*^9, 3.872832236740717*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"c76076e6-1955-452f-ae58-60a61601031a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8728322405251427`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"52000633-c945-4061-bc8b-c4965c9422b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8728322405251427`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"738da279-64ef-49c4-ab7f-a06f0fcfff70"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"j", "=", "2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"B12", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B22", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"3", "/", "2"}]}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B32", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"3", "/", "2"}]}], "}"}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8728331652185106`*^9, 3.8728331768950367`*^9}, {
  3.8728332326065836`*^9, 3.8728332666582146`*^9}, {3.8728348267704697`*^9, 
  3.872834835700049*^9}, {3.8728351651471796`*^9, 3.8728351790753665`*^9}, {
  3.8728352333163433`*^9, 3.872835240735036*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"0385a16f-a74f-4c31-a794-40dc2351e84e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Racah", " ", "matrix", " ", "for", " ", "B3"}], " ", "\[Rule]", 
    " ", "B2"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"U3", "=", 
     RowBox[{"qRacahWigner", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"B32", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{"B32", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", "2", ",", 
         RowBox[{"B22", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"U3", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8728332811017447`*^9, 3.872833283559078*^9}, {
  3.8728334224872723`*^9, 3.8728334471088066`*^9}, {3.8728337233006935`*^9, 
  3.872833723477665*^9}, {3.872834441040797*^9, 3.8728344437883635`*^9}, {
  3.8728344876811037`*^9, 3.8728344970322204`*^9}, {3.872834787108477*^9, 
  3.872834812688102*^9}, {3.8728348706755233`*^9, 3.872834870889179*^9}, {
  3.872835409122357*^9, 3.872835420118143*^9}, {3.8728359779494524`*^9, 
  3.8728359952502375`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"2f417066-21b9-464c-b80b-1271b6ab42bf"],

Cell[BoxData[
 TagBox["1",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8728334287329254`*^9, 3.8728334533226347`*^9}, 
   3.8728341547824807`*^9, 3.872834444504176*^9, {3.8728344893448815`*^9, 
   3.872834497502248*^9}, {3.872834808281535*^9, 3.872834813089051*^9}, {
   3.8728348509859324`*^9, 3.872834876682184*^9}, {3.872835190635292*^9, 
   3.872835195541845*^9}, 3.872835246996299*^9, 3.8728359999196105`*^9},
 CellLabel->
  "Out[150]//MatrixForm=",ExpressionUUID->"b86ebb19-1bc8-4070-bf87-\
e96f52930c12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Racah", " ", "matrix", " ", "for", " ", "B3"}], " ", "\[Rule]", 
    " ", "B1"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"B12", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"B32", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"qRacahWigner", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"B32", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"B32", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", "2", ",", 
             RowBox[{"B12", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"X3", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8728334909653473`*^9, 3.8728335154845085`*^9}, {
  3.8728340577044168`*^9, 3.87283405900524*^9}, {3.872834126396905*^9, 
  3.872834126573943*^9}, {3.872835604888492*^9, 3.8728356271385965`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"d6b4413e-37f3-4eb2-9735-ba045308b0d2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8728335189528246`*^9, 3.8728336747325883`*^9, 
  3.872834059565645*^9, 3.8728341270214787`*^9, 3.87283562919076*^9},
 CellLabel->
  "Out[148]//MatrixForm=",ExpressionUUID->"c0607108-5fab-4415-9a0e-\
4726224b83f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Change", " ", "of", " ", "basis", " ", "B1"}], " ", "\[Rule]", 
    " ", "B2"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S3", "=", 
     RowBox[{"U3", "*", "X3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"S3", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.872834181515585*^9, 3.8728341884176655`*^9}, {
  3.872836012694516*^9, 3.8728360182748613`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"b1adac46-8f92-45ef-9c3a-d0dc81f97a22"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8728341888275323`*^9, {3.8728360055041237`*^9, 3.8728360192775607`*^9}},
 CellLabel->
  "Out[154]//MatrixForm=",ExpressionUUID->"cf73e405-d341-4498-af23-\
0abfb50a8fe5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Eigenvalues", " ", "of", " ", "R"}], "-", 
     RowBox[{"matrices", " ", "for", " ", "j"}]}], "=", "1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T112", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B12", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B12", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B12", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T122", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B22", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B22", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B22", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T132", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "-", 
           RowBox[{"B12", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}]], 
         SuperscriptBox["q", 
          RowBox[{
           RowBox[{"B12", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B12", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", "1"}], ")"}]}]]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"T112", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"T122", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"T132", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8728342098223124`*^9, 3.8728342583393364`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"f18b2fee-f11e-4fda-874a-1bb15412d564"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.872834246680313*^9, 3.87283425917157*^9}, 
   3.8728360225083885`*^9},
 CellLabel->
  "Out[158]//MatrixForm=",ExpressionUUID->"cd43e400-7caf-4b5a-8e0f-\
ab8874d7fc5a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.872834246680313*^9, 3.87283425917157*^9}, 
   3.8728360225193596`*^9},
 CellLabel->
  "Out[159]//MatrixForm=",ExpressionUUID->"a303f477-85e8-4582-a028-\
512e92222e9e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox["q", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.872834246680313*^9, 3.87283425917157*^9}, 
   3.872836022526341*^9},
 CellLabel->
  "Out[160]//MatrixForm=",ExpressionUUID->"31c31377-73e6-44d6-a889-\
be2c1bba1ce0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"T112", ".", 
         RowBox[{"Transpose", "[", "S3", "]"}], ".", "T122", ".", "S3", ".", 
         "T112"}], ",", 
        RowBox[{"qAssum", "[", "3", "]"}]}], "]"}], "-", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "S3", "]"}], ".", "T122", ".", "S3", ".", 
         "T112", ".", 
         RowBox[{"Transpose", "[", "S3", "]"}], ".", "T122", ".", "S3"}], ",", 
        RowBox[{"qAssum", "[", "3", "]"}]}], "]"}]}], ")"}], "/.", "qsubs"}], 
   ",", 
   RowBox[{"q", ">", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"T132", ".", 
         RowBox[{"Transpose", "[", "S3", "]"}], ".", "T122", ".", "S3", ".", 
         "T132"}], ",", 
        RowBox[{"qAssum", "[", "3", "]"}]}], "]"}], "-", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "S3", "]"}], ".", "T122", ".", "S3", ".", 
         "T132", ".", 
         RowBox[{"Transpose", "[", "S3", "]"}], ".", "T122", ".", "S3"}], ",", 
        RowBox[{"qAssum", "[", "3", "]"}]}], "]"}]}], ")"}], "/.", "qsubs"}], 
   ",", 
   RowBox[{"q", ">", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.872834277606017*^9, 3.8728343307997503`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"1168f3f6-e92a-4b16-be66-f708f1686265"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8728343315067244`*^9, 3.872836025317051*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"9512fcd1-3d0f-4cb9-9a5d-06a899472064"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8728343315067244`*^9, 3.8728360253260226`*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"2751fb59-1847-4367-a3af-8cebc99cf4e1"]
}, Open  ]]
},
WindowSize->{1264, 661},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.55 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1596, 46, 271, "Input",ExpressionUUID->"f07d8d8b-4cdd-4ac2-b463-a20e101f3c43"],
Cell[2157, 68, 707, 14, 66, "Input",ExpressionUUID->"ce087af6-e8b1-4a0c-89e3-d5e240d93ca2"],
Cell[2867, 84, 7811, 199, 760, "Input",ExpressionUUID->"cd803d39-84b6-4e13-a501-4587118a5c96"],
Cell[CellGroupData[{
Cell[10703, 287, 1762, 50, 205, "Input",ExpressionUUID->"7e1f824b-72fe-46b1-b79e-7b9f12b2da86"],
Cell[12468, 339, 865, 24, 146, "Output",ExpressionUUID->"48d2705a-66cb-4303-91af-620e0e98fc32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13370, 368, 2317, 62, 423, "Input",ExpressionUUID->"6dcf4b9f-8282-414d-ae4c-6e55ecc3b160"],
Cell[15690, 432, 7040, 175, 400, "Output",ExpressionUUID->"23cf3a2e-8f0c-4f4e-b9fb-bda98a0c1d4a"]
}, Open  ]],
Cell[22745, 610, 4826, 118, 571, "Input",ExpressionUUID->"87fc8456-18e2-4997-8f63-fec86743cf89"],
Cell[27574, 730, 201, 5, 42, "Input",ExpressionUUID->"08df1fe9-5f3b-4d9e-bded-b6aa20dc5b6c"],
Cell[27778, 737, 1414, 43, 99, "Input",ExpressionUUID->"0e37994d-fdc6-4211-a006-feab36c1b298"],
Cell[CellGroupData[{
Cell[29217, 784, 2355, 56, 233, "Input",ExpressionUUID->"33531bfb-6863-4891-8406-90b634f77bf2"],
Cell[31575, 842, 1829, 48, 154, "Output",ExpressionUUID->"c338b2b3-ac84-4e73-aa5d-6655a2b4ad31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33441, 895, 1831, 50, 233, "Input",ExpressionUUID->"5b691d81-56c0-4998-b23f-10620de0b41a"],
Cell[35275, 947, 1283, 37, 139, "Output",ExpressionUUID->"24c72957-7ca1-4dca-a28c-68f5cf4dacff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36595, 989, 572, 15, 149, "Input",ExpressionUUID->"b5d8e358-be22-41b1-b195-27be5bf4cbe0"],
Cell[37170, 1006, 2140, 68, 182, "Output",ExpressionUUID->"bc0c9f24-2cfd-4a28-8cf8-2ca3822b12e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39347, 1079, 3359, 98, 385, "Input",ExpressionUUID->"d46dc022-ecc3-4c9e-9bcc-0787334a76b1"],
Cell[42709, 1179, 978, 26, 103, "Output",ExpressionUUID->"ec10d392-a8f8-465d-8f37-e701a96698d5"],
Cell[43690, 1207, 978, 26, 103, "Output",ExpressionUUID->"f54d84dd-9e49-4559-bf54-ce9fd74ee81a"],
Cell[44671, 1235, 980, 26, 103, "Output",ExpressionUUID->"c2e7508c-7d75-446a-b430-d34d64ac74de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45688, 1266, 1974, 52, 398, "Input",ExpressionUUID->"ae2196e9-36cd-4527-8502-f80f768ae4ac"],
Cell[47665, 1320, 514, 13, 48, "Output",ExpressionUUID->"e546bf9e-9eb1-492f-834f-55b4a7d5e4d5"],
Cell[48182, 1335, 515, 13, 48, "Output",ExpressionUUID->"8fcbb26b-9b19-45d4-8671-fba7aa8c6d72"]
}, Open  ]],
Cell[48712, 1351, 202, 5, 42, "Input",ExpressionUUID->"eccf3e3f-555f-400f-a52d-963924587718"],
Cell[48917, 1358, 1114, 33, 99, "Input",ExpressionUUID->"2cfa4112-1957-4e92-b499-984338e5b025"],
Cell[CellGroupData[{
Cell[50056, 1395, 1817, 48, 233, "Input",ExpressionUUID->"7ab3203a-4998-4238-a047-9e81dcd13410"],
Cell[51876, 1445, 986, 32, 133, "Output",ExpressionUUID->"8b8058ed-7f8b-4a57-a494-2d12079cdb12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52899, 1482, 1572, 44, 233, "Input",ExpressionUUID->"ef6643c4-6407-4934-9d3a-4d82b980c4e1"],
Cell[54474, 1528, 642, 19, 90, "Output",ExpressionUUID->"07555495-3e63-4b18-9378-e9d37fb06a6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55153, 1552, 540, 13, 149, "Input",ExpressionUUID->"fc134c02-d41d-4375-8b69-ee5446a4b9cf"],
Cell[55696, 1567, 1084, 33, 133, "Output",ExpressionUUID->"ecb70ca7-b6d5-4b96-a1a1-71af595abbca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56817, 1605, 3189, 95, 385, "Input",ExpressionUUID->"a8395fad-f49d-4016-98db-2e656474d2dd"],
Cell[60009, 1702, 721, 22, 93, "Output",ExpressionUUID->"6d7cd457-c552-4517-b459-6ae6e4d03434"],
Cell[60733, 1726, 719, 22, 93, "Output",ExpressionUUID->"ac093962-4cde-49c5-bf61-b53a8048a00d"],
Cell[61455, 1750, 719, 22, 96, "Output",ExpressionUUID->"fd297542-503c-4e81-9142-84a246aca343"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62211, 1777, 1604, 42, 368, "Input",ExpressionUUID->"c76076e6-1955-452f-ae58-60a61601031a"],
Cell[63818, 1821, 294, 8, 50, "Output",ExpressionUUID->"52000633-c945-4061-bc8b-c4965c9422b5"],
Cell[64115, 1831, 294, 8, 50, "Output",ExpressionUUID->"738da279-64ef-49c4-ab7f-a06f0fcfff70"]
}, Open  ]],
Cell[64424, 1842, 1016, 28, 131, "Input",ExpressionUUID->"0385a16f-a74f-4c31-a794-40dc2351e84e"],
Cell[CellGroupData[{
Cell[65465, 1874, 1448, 36, 125, "Input",ExpressionUUID->"2f417066-21b9-464c-b80b-1271b6ab42bf"],
Cell[66916, 1912, 553, 11, 70, "Output",ExpressionUUID->"b86ebb19-1bc8-4070-bf87-e96f52930c12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67506, 1928, 1793, 48, 208, "Input",ExpressionUUID->"d6b4413e-37f3-4eb2-9735-ba045308b0d2"],
Cell[69302, 1978, 695, 19, 70, "Output",ExpressionUUID->"c0607108-5fab-4415-9a0e-4726224b83f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70034, 2002, 555, 14, 125, "Input",ExpressionUUID->"b1adac46-8f92-45ef-9c3a-d0dc81f97a22"],
Cell[70592, 2018, 654, 19, 70, "Output",ExpressionUUID->"cf73e405-d341-4498-af23-0abfb50a8fe5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71283, 2042, 3144, 95, 387, "Input",ExpressionUUID->"f18b2fee-f11e-4fda-874a-1bb15412d564"],
Cell[74430, 2139, 678, 20, 72, "Output",ExpressionUUID->"cd43e400-7caf-4b5a-8e0f-ab8874d7fc5a"],
Cell[75111, 2161, 678, 20, 72, "Output",ExpressionUUID->"a303f477-85e8-4582-a028-512e92222e9e"],
Cell[75792, 2183, 676, 20, 72, "Output",ExpressionUUID->"31c31377-73e6-44d6-a889-be2c1bba1ce0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76505, 2208, 1608, 43, 368, "Input",ExpressionUUID->"1168f3f6-e92a-4b16-be66-f708f1686265"],
Cell[78116, 2253, 222, 5, 50, "Output",ExpressionUUID->"9512fcd1-3d0f-4cb9-9a5d-06a899472064"],
Cell[78341, 2260, 224, 5, 83, "Output",ExpressionUUID->"2751fb59-1847-4367-a3af-8cebc99cf4e1"]
}, Open  ]]
}
]
*)

